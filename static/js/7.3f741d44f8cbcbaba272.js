webpackJsonp([7],{Ijou:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("pFYg"),l=n.n(i),a={name:"x-content",props:{text:{type:String},textAlign:{type:String,default:"left"},verticalAlign:{type:String,default:"top"}}},r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cell-container"},[e("div",{staticClass:"cell-content",attrs:{cellpadding:"0"}},[e("div",{staticClass:"x-cell",style:{"text-align":this.textAlign,"vertical-align":this.verticalAlign}},[this._v("\n      "+this._s(this.text)+"\n    ")])])])},staticRenderFns:[]};var s={name:"x-cell",components:{XContent:n("VU/8")(a,r,!1,function(t){n("mfl6")},"data-v-293b4dc2",null).exports},inject:["cellSize"],props:{colspan:{type:Number,default:1},rowspan:{type:Number,default:1},text:{type:String},width:{type:Number},height:{type:Number},rowIndex:{type:Number,required:!0},cellIndex:{type:Number,required:!0},textAlign:{type:String,default:"left"},verticalAlign:{type:String,default:"top"}},computed:{style:function(){var t={};return void 0!==this.height?t.height=this.height+"px":0===this.cellIndex&&(t.height=this.cellSize.height+"px"),void 0!==this.width?t.width=this.width+"px":0===this.rowIndex&&(t.width=this.cellSize.width+"px"),t}}},o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("td",{attrs:{colspan:this.colspan,rowspan:this.rowspan}},[e("x-content",{style:this.style,attrs:{text:this.text,textAlign:this.textAlign,verticalAlign:this.verticalAlign}})],1)},staticRenderFns:[]};var c={name:"x-row",components:{XCell:n("VU/8")(s,o,!1,function(t){n("TlSb")},"data-v-eeb2495a",null).exports},props:{columns:{type:Array,required:!0},rowIndex:{type:Number,required:!0}}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",t._l(t.columns,function(e,i){return n("x-cell",{key:e.key,attrs:{rowspan:e.rowspan,colspan:e.colspan,text:e.text,cellIndex:i,rowIndex:t.rowIndex,width:e.width,height:e.height,textAlign:e.textAlign,verticalAlign:e.verticalAlign}})}),1)},staticRenderFns:[]};var d={name:"xtable-content",components:{XRow:n("VU/8")(c,u,!1,function(t){n("sdVy")},"data-v-336ef310",null).exports},props:{table:{type:Array}}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("table",{ref:"table",staticClass:"x-table-content",attrs:{cellspacing:"0",cellpadding:"0"}},[e("tbody",this._l(this.table,function(t,n){return e("x-row",{key:n,attrs:{columns:t,rowIndex:n}})}),1)])},staticRenderFns:[]};var f=n("VU/8")(d,h,!1,function(t){n("c/fp")},"data-v-167b75d8",null).exports,x=function(t,e){return t>e?e:t},p=function(t,e){return t<e?e:t},v=function(t,e,n){return t>=e&&t<=n},y=function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1},b=function(t,e){for(var n=-1,i=0;i<t.length;i++)e(t[i])&&(n=i);return n},g={name:"x-table",components:{XtableContent:f},provide:function(){return{cellSize:this.cellSize}},watch:{scrollLeft:function(t){this.$refs.tableHeader.$el.scrollLeft=t},scrollTop:function(t){this.$refs.tableRownum.$el.scrollTop=t},selectEnd:function(){this.setSelectArea()}},computed:{selectAreaStyle:function(){if(this.selectedArea){var t=this.getCoordinate(),e=this.$refs.tableBody.$children[0].$el.children[0].children,n=e[t.y1].children[t.x1].getBoundingClientRect(),i=e[t.y2].children[t.x2].getBoundingClientRect(),l=i.left-n.left+i.width-1,a=i.top-n.top+i.height-1,r=this.$refs.tableBody.$el.getBoundingClientRect();return{width:l+"px",height:a+"px",top:n.y-r.top-1+"px",left:n.x-r.left-this.scrollLeft-1+"px"}}return{display:"none"}}},data:function(){return{cellSize:{width:80,height:28},rows:30,cols:20,scrollLeft:0,scrollTop:0,selectStart:null,selectEnd:null,selectedArea:null,header:null,rownum:null,tableData:null,editCell:null}},mounted:function(){this.initTableHeader(),this.initTableRownum(),this.initTableData()},methods:{getCoordinate:function(){var t=this.selectedArea,e=this.tableData[t.y1].findIndex(function(e){return e.x===t.x1}),n=this.findTopLeftCell(t.x2,t.y2);return{x1:e,y1:t.y1,x2:this.tableData[n.y].indexOf(n),y2:n.y}},initTableHeader:function(){for(var t=[],e=0;e<this.cols;e++)t.push({text:this.numberToletter(e),x:e,y:0,textAlign:"center",verticalAlign:"middle"});this.header=[t]},initTableRownum:function(){for(var t=[],e=this.cellSize.height,n=0;n<this.rows;n++)t.push([{text:n+1+"",x:0,y:n,textAlign:"center",verticalAlign:"middle",width:e}]);this.rownum=t},initTableData:function(){for(var t=[],e=0;e<this.rows;e++){for(var n=[],i=0;i<this.cols;i++)n.push({x:i,y:e,colspan:1,rowspan:1});t.push(n)}this.tableData=t},setSelectArea:function(){var t=this.tableData[this.selectStart[1]][this.selectStart[0]],e=this.tableData[this.selectEnd[1]][this.selectEnd[0]],n={x1:x(t.x,e.x),y1:x(t.y,e.y),x2:p(t.x+t.colspan-1,e.x+e.colspan-1),y2:p(t.y+t.rowspan-1,e.y+e.rowspan-1)};this.calcSelectArea(n),this.selectedArea=n},findTopPosition:function(t,e){for(var n=e-1;n>=0;n--){var i=this.tableData[n].findIndex(function(e){return e.x===t});if(-1!==i)return{x:i,y:n,data:this.tableData[n][i]}}},findTopLeftCell:function(t,e){for(var n=e;n>=0;n--){var i=this.tableData[n].findIndex(function(n){return v(t,n.x,n.x+n.colspan-1)&&v(e,n.y,n.y+n.rowspan-1)});if(-1!==i)return this.tableData[n][i]}},calcSelectArea:function(t){var e=this;if(-1===this.tableData[t.y1].findIndex(function(e){return e.x===t.x1})){var n=this.findTopLeftCell(t.x1,t.y1);t.x1=n.x,t.y1=n.y,t.x1=x(t.x1,t.x2),t.y1=x(t.y1,t.y2),t.x2=p(t.x1,t.x2),t.y2=p(t.y1,t.y2)}for(var i=function(n){var i=e.tableData[t.y1].findIndex(function(t){return t.x===n}),l=null;if(!((l=-1===i?e.findTopPosition(n,t.y1).data:e.tableData[t.y1][i]).x+l.colspan-1<=t.x2&&l.y===t.y1))return l.x+l.colspan-1>t.x2&&(t.x2=l.x+l.colspan-1),l.y<t.y1&&(t.y1=l.y),e.calcSelectArea(t),{v:void 0};n+=l.colspan-1,a=n},a=t.x1;a<=t.x2;a++){var r=i(a);if("object"===(void 0===r?"undefined":l()(r)))return r.v}for(a=t.y1;a<=t.y2;a++){var s=this.tableData[a].findIndex(function(e){return e.x===t.x1});-1===s&&(s=b(this.tableData[a],function(e){return e.x<=t.x1}));var o=this.tableData[a][s];if(!(o.x===t.x1&&o.y+o.rowspan-1<=t.y2))return o.y+o.rowspan-1>t.y2&&(t.y2=o.y+o.rowspan-1),o.x<t.x1&&(t.x1=o.x),void this.calcSelectArea(t);a+=o.rowspan-1}for(var c=function(n){var i=e.tableData[t.y2].findIndex(function(t){return t.x===n}),l=null;if(!((l=-1===i?e.findTopPosition(n,t.y2).data:e.tableData[t.y2][i]).y+l.rowspan-1===t.y2&&l.x+l.colspan-1<=t.x2))return l.y+l.rowspan-1>t.y2&&(t.y2=l.y+l.rowspan-1),l.x+l.colspan-1>t.x2&&(t.x2=l.x+l.colspan-1),e.calcSelectArea(t),{v:void 0};n+=l.colspan-1,u=n},u=t.x1;u<=t.x2;u++){var d=c(u);if("object"===(void 0===d?"undefined":l()(d)))return d.v}for(var h=t.y1;h<=t.y2;h++){var f=this.tableData[h].findIndex(function(e){return e.x+e.colspan-1===t.x2});-1===f&&(f=b(this.tableData[h],function(e){return e.x<=t.x2}));var v=this.tableData[h][f];if(!(v.x+v.colspan-1===t.x2&&v.y+v.rowspan-1<=t.y2))return v.x+v.colspan-1>t.x2&&(t.x2=v.x+v.colspan-1),v.y+v.rowspan-1>t.y2&&(t.y2=v.y+v.rowspan-1),void this.calcSelectArea(t);h+=v.rowspan-1}},numberToletter:function(t,e){var n=String.fromCharCode(65+t%26)+(e||""),i=parseInt(t/26);return i>0&&(n=this.numberToletter(i-1,n)),n},scroll:function(){this.scrollLeft=this.$refs.tableBody.$el.scrollLeft,this.scrollTop=this.$refs.tableBody.$el.scrollTop},mousedown:function(t){var e=this.getPosition(t.clientX,t.clientY);this.isSamePosition(e)||(this.editCell=null),this.selectEnd=this.selectStart=e,this.$refs.xTable.$el.addEventListener("mouseleave",this.mouseup),document.body.addEventListener("mousemove",this.selecting),document.body.addEventListener("mouseup",this.mouseup)},mouseup:function(t){this.$refs.xTable.$el.removeEventListener("mouseleave",this.mouseup),document.body.removeEventListener("mousemove",this.selecting),document.body.removeEventListener("mouseup",this.mouseup)},dblclick:function(t){var e=this.getPosition(t.clientX,t.clientY);this.editCell=this.tableData[e[1]][e[0]],this.editCell.isEditing=!0},isSamePosition:function(t){var e=!1;return this.selectStart?this.selectStart[0]===t[0]&&this.selectStart[1]===t[1]&&this.selectEnd[0]===t[0]&&this.selectEnd[1]===t[1]&&(e=!0):e=!0,e},selecting:function(t){var e=this.getPosition(t.clientX,t.clientY);e[0]===this.selectEnd[0]&&e[1]===this.selectEnd[1]||(this.selectEnd=e,this.editCell=null)},getPosition:function(t,e){var n=event.clientX,i=event.clientY;return[this.getPositionX(n),this.getPositionY(i)]},getPositionX:function(t){var e=this.$refs.tableHeader.$children[0].$el.children[0].children[0].children,n=e[0].getBoundingClientRect(),i=e[e.length-1].getBoundingClientRect();if(t<n.left)return 0;if(i.left+i.width<t)return e.length-1;for(var l=0;l<e.length;l++){var a=e[l].getBoundingClientRect();if(a.left<=t&&t<a.left+a.width)return l}},getPositionY:function(t){var e=this.$refs.tableRownum.$children[0].$el.children[0].children,n=e[0].getBoundingClientRect(),i=e[e.length-1].getBoundingClientRect();if(t<n.top)return 0;if(i.top+i.height<t)return e.length-1;for(var l=0;l<e.length;l++){var a=e[l].getBoundingClientRect();if(a.top<=t&&t<a.top+a.height)return l}},mergeCell:function(){var t=this.selectedArea,e=this.tableData[t.y1],n=e.findIndex(function(t){return t.selected}),i=b(e,function(t){return t.selected});this.tableData[t.y1][n].rowspan=t.y2-t.y1+1,this.tableData[t.y1][n].colspan=t.x2-t.x1+1,e.splice(n+1,i-n);for(var l=t.y1+1;l<=t.y2;l++){e=this.tableData[l];var a=y(e,function(t){return t.selected}),r=b(e,function(t){return t.selected});-1!==a&&-1!==r&&e.splice(a,r-a+1)}this.selectedArea.x2=this.selectedArea.x1,this.selectedArea.y2=this.selectedArea.y1,this.setSelectArea(this.selectedArea.start,this.selectedArea.end),this.showMenu=!1},cellBorder:function(){for(var t=this.selectedArea,e=t.y1;e<=t.y2;e++){this.tableData[e].filter(function(t){return t.selected}).map(function(t){var e=t.style||{};e.border="1px solid #212121",t.style=e})}this.setSelected(this.selectedArea,!1),this.showMenu=!1}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{staticClass:"container"},[n("el-header",{staticClass:"x-table-tool",staticStyle:{height:"auto"}},[n("div",{staticClass:"tool-align"},[n("el-button-group",[n("el-button",{attrs:{size:"mini",icon:"fc-icon-vertical-align-top"}}),t._v(" "),n("el-button",{attrs:{size:"mini",icon:"fc-icon-vertical-align-middl"}}),t._v(" "),n("el-button",{attrs:{size:"mini",icon:"fc-icon-vertical-align-botto"}})],1),t._v(" "),n("el-button-group",[n("el-button",{attrs:{size:"mini",icon:"fc-icon-align-left"}}),t._v(" "),n("el-button",{attrs:{size:"mini",icon:"fc-icon-align-center"}}),t._v(" "),n("el-button",{attrs:{size:"mini",icon:"fc-icon-align-right"}})],1)],1)]),t._v(" "),n("el-container",{ref:"xTable",staticClass:"x-table"},[n("el-container",{staticClass:"x-table-rownum"},[n("el-header",{staticClass:"x-table-header",style:{height:t.cellSize.height+"px!important"}}),t._v(" "),n("el-main",{ref:"tableRownum",staticClass:"x-rownum-container"},[n("xtable-content",{attrs:{table:t.rownum}})],1)],1),t._v(" "),n("el-container",{staticClass:"x-table-view"},[n("el-header",{staticClass:"x-table-header"},[n("el-container",[n("el-main",{ref:"tableHeader",staticClass:"x-header-container"},[n("xtable-content",{attrs:{table:t.header}})],1),t._v(" "),n("el-aside",{attrs:{width:"8px"}})],1)],1),t._v(" "),n("el-main",{ref:"tableBody",staticClass:"x-table-body",nativeOn:{scroll:function(e){return t.scroll(e)},dblclick:function(e){t.dblclick(e)}}},[n("div",{on:{mousedown:function(e){t.mousedown(e)}}},[n("div",{staticClass:"select-area",style:t.selectAreaStyle},[t.editCell?n("input",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model",value:t.editCell.text,expression:"editCell.text"}],ref:"cellValue",domProps:{value:t.editCell.text},on:{input:function(e){e.target.composing||t.$set(t.editCell,"text",e.target.value)}}}):t._e()]),t._v(" "),n("xtable-content",{attrs:{table:t.tableData}})],1)])],1)],1)],1)},staticRenderFns:[]};var w=n("VU/8")(g,m,!1,function(t){n("sW9n")},"data-v-0454e87a",null);e.default=w.exports},TlSb:function(t,e){},"c/fp":function(t,e){},mfl6:function(t,e){},sW9n:function(t,e){},sdVy:function(t,e){}});